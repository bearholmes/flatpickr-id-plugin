{"version":3,"file":"index.js","sources":["../../src/index.ts"],"sourcesContent":["import { Plugin } from 'flatpickr/dist/types/options';\nimport type { Instance } from 'flatpickr/dist/types/instance';\n\n/**\n * Attributes that will be transferred from the original input to the flatpickr-generated input\n */\nconst TRANSFERABLE_ATTRIBUTES = [\n  'id',\n  'title',\n  'aria-label',\n  'aria-labelledby',\n] as const;\n\n/**\n * Delay in milliseconds before transferring attributes\n * This ensures flatpickr has fully initialized its DOM elements\n */\nconst ATTRIBUTE_TRANSFER_DELAY_MS = 10;\n\n/**\n * Configuration options for the idPlugin\n */\nexport interface IdPluginConfig {\n  /**\n   * Custom delay in milliseconds before transferring attributes\n   * @default 10\n   */\n  delay?: number;\n\n  /**\n   * Custom list of attributes to transfer\n   * @default ['id', 'title', 'aria-label', 'aria-labelledby']\n   */\n  attributes?: readonly string[];\n\n  /**\n   * Enable debug logging\n   * @default false\n   */\n  debug?: boolean;\n}\n\n/**\n * flatpickr plugin that transfers ID and accessibility attributes from the original input\n * to the actual input element created by flatpickr (either mobileInput or altInput).\n *\n * This is useful for maintaining proper form labels, accessibility, and unique identifiers\n * when flatpickr replaces or hides the original input element.\n *\n * @param config - Optional configuration for the plugin\n * @returns flatpickr Plugin function\n *\n * @example\n * ```typescript\n * import flatpickr from 'flatpickr';\n * import idPlugin from 'flatpickr-id-plugin';\n *\n * flatpickr('#myInput', {\n *   plugins: [idPlugin()]\n * });\n * ```\n *\n * @example\n * ```typescript\n * // With custom configuration\n * flatpickr('#myInput', {\n *   plugins: [idPlugin({\n *     delay: 20,\n *     debug: true\n *   })]\n * });\n * ```\n */\nfunction idPlugin(config: IdPluginConfig = {}): Plugin {\n  const {\n    delay = ATTRIBUTE_TRANSFER_DELAY_MS,\n    attributes = TRANSFERABLE_ATTRIBUTES,\n    debug = false,\n  } = config;\n\n  return (fp: Instance): Record<string, unknown> => {\n    /**\n     * Logs debug messages if debug mode is enabled\n     */\n    const log = (...args: unknown[]): void => {\n      if (debug) {\n        console.log('[flatpickr-id-plugin]', ...args);\n      }\n    };\n\n    /**\n     * Transfers attributes from source element to target element\n     */\n    const transferAttributes = (): void => {\n      try {\n        const sourceElement = fp.input;\n        const targetElement = fp.mobileInput || fp.altInput;\n\n        if (!targetElement) {\n          log('No target element (mobileInput or altInput) found');\n          return;\n        }\n\n        log('Transferring attributes from', sourceElement, 'to', targetElement);\n\n        let transferredCount = 0;\n\n        for (const attributeName of attributes) {\n          const attributeValue = sourceElement.getAttribute(attributeName);\n\n          if (attributeValue) {\n            sourceElement.removeAttribute(attributeName);\n            targetElement.setAttribute(attributeName, attributeValue);\n            transferredCount++;\n            log(`Transferred ${attributeName}=\"${attributeValue}\"`);\n          }\n        }\n\n        log(`Transfer complete: ${transferredCount} attributes transferred`);\n\n        // Register plugin in loadedPlugins array\n        if (fp.loadedPlugins && !fp.loadedPlugins.includes('idPlugin')) {\n          fp.loadedPlugins.push('idPlugin');\n        }\n      } catch (error) {\n        console.error(\n          '[flatpickr-id-plugin] Error transferring attributes:',\n          error,\n        );\n      }\n    };\n\n    return {\n      /**\n       * Called when flatpickr is ready\n       * Transfers attributes after a short delay to ensure DOM is fully initialized\n       */\n      onReady(): void {\n        setTimeout(transferAttributes, delay);\n      },\n    };\n  };\n}\n\nexport default idPlugin;\n"],"names":[],"mappings":"AAGA;;AAEG;AACH,MAAM,uBAAuB,GAAG;IAC9B,IAAI;IACJ,OAAO;IACP,YAAY;IACZ,iBAAiB;CACT;AAEV;;;AAGG;AACH,MAAM,2BAA2B,GAAG,EAAE;AAyBtC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BG;AACH,SAAS,QAAQ,CAAC,MAAA,GAAyB,EAAE,EAAA;AAC3C,IAAA,MAAM,EACJ,KAAK,GAAG,2BAA2B,EACnC,UAAU,GAAG,uBAAuB,EACpC,KAAK,GAAG,KAAK,GACd,GAAG,MAAM;IAEV,OAAO,CAAC,EAAY,KAA6B;AAC/C;;AAEG;AACH,QAAA,MAAM,GAAG,GAAG,CAAC,GAAG,IAAe,KAAU;YACvC,IAAI,KAAK,EAAE;gBACT,OAAO,CAAC,GAAG,CAAC,uBAAuB,EAAE,GAAG,IAAI,CAAC;YAC/C;AACF,QAAA,CAAC;AAED;;AAEG;QACH,MAAM,kBAAkB,GAAG,MAAW;AACpC,YAAA,IAAI;AACF,gBAAA,MAAM,aAAa,GAAG,EAAE,CAAC,KAAK;gBAC9B,MAAM,aAAa,GAAG,EAAE,CAAC,WAAW,IAAI,EAAE,CAAC,QAAQ;gBAEnD,IAAI,CAAC,aAAa,EAAE;oBAClB,GAAG,CAAC,mDAAmD,CAAC;oBACxD;gBACF;gBAEA,GAAG,CAAC,8BAA8B,EAAE,aAAa,EAAE,IAAI,EAAE,aAAa,CAAC;gBAEvE,IAAI,gBAAgB,GAAG,CAAC;AAExB,gBAAA,KAAK,MAAM,aAAa,IAAI,UAAU,EAAE;oBACtC,MAAM,cAAc,GAAG,aAAa,CAAC,YAAY,CAAC,aAAa,CAAC;oBAEhE,IAAI,cAAc,EAAE;AAClB,wBAAA,aAAa,CAAC,eAAe,CAAC,aAAa,CAAC;AAC5C,wBAAA,aAAa,CAAC,YAAY,CAAC,aAAa,EAAE,cAAc,CAAC;AACzD,wBAAA,gBAAgB,EAAE;AAClB,wBAAA,GAAG,CAAC,CAAA,YAAA,EAAe,aAAa,KAAK,cAAc,CAAA,CAAA,CAAG,CAAC;oBACzD;gBACF;AAEA,gBAAA,GAAG,CAAC,CAAA,mBAAA,EAAsB,gBAAgB,CAAA,uBAAA,CAAyB,CAAC;;AAGpE,gBAAA,IAAI,EAAE,CAAC,aAAa,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,QAAQ,CAAC,UAAU,CAAC,EAAE;AAC9D,oBAAA,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC;gBACnC;YACF;YAAE,OAAO,KAAK,EAAE;AACd,gBAAA,OAAO,CAAC,KAAK,CACX,sDAAsD,EACtD,KAAK,CACN;YACH;AACF,QAAA,CAAC;QAED,OAAO;AACL;;;AAGG;YACH,OAAO,GAAA;AACL,gBAAA,UAAU,CAAC,kBAAkB,EAAE,KAAK,CAAC;YACvC,CAAC;SACF;AACH,IAAA,CAAC;AACH;;;;"}